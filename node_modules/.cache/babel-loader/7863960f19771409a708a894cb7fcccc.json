{"remainingRequest":"C:\\dts-shop\\admin-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!C:\\dts-shop\\admin-ui\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\dts-shop\\admin-ui\\src\\store\\modules\\permission.js","dependencies":[{"path":"C:\\dts-shop\\admin-ui\\src\\store\\modules\\permission.js","mtime":1714111780000},{"path":"C:\\dts-shop\\admin-ui\\babel.config.js","mtime":1714111780000},{"path":"C:\\dts-shop\\admin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742308433329},{"path":"C:\\dts-shop\\admin-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1742308433476},{"path":"C:\\dts-shop\\admin-ui\\node_modules\\eslint-loader\\index.js","mtime":1742308437914}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJDOi9kdHMtc2hvcC9hZG1pbi11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKdmFyIF9vYmplY3RTcHJlYWQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJDOi9kdHMtc2hvcC9hZG1pbi11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9vYmplY3RTcHJlYWQyLmpzIikpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyIpOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuY29uc3RydWN0b3IuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmZvci1lYWNoLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5pdGVyYXRvci5zb21lLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiKTsKdmFyIF9yb3V0ZXIgPSByZXF1aXJlKCJAL3JvdXRlciIpOwovKioKICog6YCa6L+HbWV0YS5wZXJtc+WIpOaWreaYr+WQpuS4juW9k+WJjeeUqOaIt+adg+mZkOWMuemFjQogKiBAcGFyYW0gcGVybXMKICogQHBhcmFtIHJvdXRlCiAqLwpmdW5jdGlvbiBoYXNQZXJtaXNzaW9uKHBlcm1zLCByb3V0ZSkgewogIGlmIChyb3V0ZS5tZXRhICYmIHJvdXRlLm1ldGEucGVybXMpIHsKICAgIHJldHVybiBwZXJtcy5zb21lKGZ1bmN0aW9uIChwZXJtKSB7CiAgICAgIHJldHVybiByb3V0ZS5tZXRhLnBlcm1zLmluY2x1ZGVzKHBlcm0pOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLyoqCiAqIOmAkuW9kui/h+a7pOW8guatpei3r+eUseihqO+8jOi/lOWbnuespuWQiOeUqOaIt+inkuiJsuadg+mZkOeahOi3r+eUseihqAogKiBAcGFyYW0gcm91dGVzIGFzeW5jUm91dGVyTWFwCiAqIEBwYXJhbSBwZXJtcwogKi8KZnVuY3Rpb24gZmlsdGVyQXN5bmNSb3V0ZXIocm91dGVzLCBwZXJtcykgewogIHZhciByZXMgPSBbXTsKICByb3V0ZXMuZm9yRWFjaChmdW5jdGlvbiAocm91dGUpIHsKICAgIHZhciB0bXAgPSAoMCwgX29iamVjdFNwcmVhZDIuZGVmYXVsdCkoe30sIHJvdXRlKTsKICAgIGlmICh0bXAuY2hpbGRyZW4pIHsKICAgICAgdG1wLmNoaWxkcmVuID0gZmlsdGVyQXN5bmNSb3V0ZXIodG1wLmNoaWxkcmVuLCBwZXJtcyk7CiAgICAgIGlmICh0bXAuY2hpbGRyZW4gJiYgdG1wLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICByZXMucHVzaCh0bXApOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBpZiAoaGFzUGVybWlzc2lvbihwZXJtcywgdG1wKSkgewogICAgICAgIHJlcy5wdXNoKHRtcCk7CiAgICAgIH0KICAgIH0KICB9KTsKICByZXR1cm4gcmVzOwp9CnZhciBwZXJtaXNzaW9uID0gewogIHN0YXRlOiB7CiAgICByb3V0ZXJzOiBfcm91dGVyLmNvbnN0YW50Um91dGVyTWFwLAogICAgYWRkUm91dGVyczogW10KICB9LAogIG11dGF0aW9uczogewogICAgU0VUX1JPVVRFUlM6IGZ1bmN0aW9uIFNFVF9ST1VURVJTKHN0YXRlLCByb3V0ZXJzKSB7CiAgICAgIHN0YXRlLmFkZFJvdXRlcnMgPSByb3V0ZXJzOwogICAgICBzdGF0ZS5yb3V0ZXJzID0gX3JvdXRlci5jb25zdGFudFJvdXRlck1hcC5jb25jYXQocm91dGVycyk7CiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBHZW5lcmF0ZVJvdXRlczogZnVuY3Rpb24gR2VuZXJhdGVSb3V0ZXMoX3JlZiwgZGF0YSkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIHZhciBwZXJtcyA9IGRhdGEucGVybXM7CiAgICAgICAgdmFyIGFjY2Vzc2VkUm91dGVyczsKICAgICAgICBpZiAocGVybXMuaW5jbHVkZXMoJyonKSkgewogICAgICAgICAgYWNjZXNzZWRSb3V0ZXJzID0gX3JvdXRlci5hc3luY1JvdXRlck1hcDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWNjZXNzZWRSb3V0ZXJzID0gZmlsdGVyQXN5bmNSb3V0ZXIoX3JvdXRlci5hc3luY1JvdXRlck1hcCwgcGVybXMpOwogICAgICAgIH0KICAgICAgICBjb21taXQoJ1NFVF9ST1VURVJTJywgYWNjZXNzZWRSb3V0ZXJzKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pOwogICAgfQogIH0KfTsKdmFyIF9kZWZhdWx0ID0gZXhwb3J0cy5kZWZhdWx0ID0gcGVybWlzc2lvbjs="},{"version":3,"names":["_router","require","hasPermission","perms","route","meta","some","perm","includes","filterAsyncRouter","routes","res","forEach","tmp","_objectSpread2","default","children","length","push","permission","state","routers","constantRouterMap","addRouters","mutations","SET_ROUTERS","concat","actions","GenerateRoutes","_ref","data","commit","Promise","resolve","accessedRouters","asyncRouterMap","_default","exports"],"sources":["C:/dts-shop/admin-ui/src/store/modules/permission.js"],"sourcesContent":["import { asyncRouterMap, constantRouterMap } from '@/router'\n\n/**\n * 通过meta.perms判断是否与当前用户权限匹配\n * @param perms\n * @param route\n */\nfunction hasPermission(perms, route) {\n  if (route.meta && route.meta.perms) {\n    return perms.some(perm => route.meta.perms.includes(perm))\n  } else {\n    return true\n  }\n}\n\n/**\n * 递归过滤异步路由表，返回符合用户角色权限的路由表\n * @param routes asyncRouterMap\n * @param perms\n */\nfunction filterAsyncRouter(routes, perms) {\n  const res = []\n\n  routes.forEach(route => {\n    const tmp = { ...route }\n    if (tmp.children) {\n      tmp.children = filterAsyncRouter(tmp.children, perms)\n      if (tmp.children && tmp.children.length > 0) {\n        res.push(tmp)\n      }\n    } else {\n      if (hasPermission(perms, tmp)) {\n        res.push(tmp)\n      }\n    }\n  })\n\n  return res\n}\n\nconst permission = {\n  state: {\n    routers: constantRouterMap,\n    addRouters: []\n  },\n  mutations: {\n    SET_ROUTERS: (state, routers) => {\n      state.addRouters = routers\n      state.routers = constantRouterMap.concat(routers)\n    }\n  },\n  actions: {\n    GenerateRoutes({ commit }, data) {\n      return new Promise(resolve => {\n        const { perms } = data\n        let accessedRouters\n        if (perms.includes('*')) {\n          accessedRouters = asyncRouterMap\n        } else {\n          accessedRouters = filterAsyncRouter(asyncRouterMap, perms)\n        }\n        commit('SET_ROUTERS', accessedRouters)\n        resolve()\n      })\n    }\n  }\n}\n\nexport default permission\n"],"mappings":";;;;;;;;;;;;;;;;;AAAA,IAAAA,OAAA,GAAAC,OAAA;AAEA;AACA;AACA;AACA;AACA;AACA,SAASC,aAAaA,CAACC,KAAK,EAAEC,KAAK,EAAE;EACnC,IAAIA,KAAK,CAACC,IAAI,IAAID,KAAK,CAACC,IAAI,CAACF,KAAK,EAAE;IAClC,OAAOA,KAAK,CAACG,IAAI,CAAC,UAAAC,IAAI;MAAA,OAAIH,KAAK,CAACC,IAAI,CAACF,KAAK,CAACK,QAAQ,CAACD,IAAI,CAAC;IAAA,EAAC;EAC5D,CAAC,MAAM;IACL,OAAO,IAAI;EACb;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,SAASE,iBAAiBA,CAACC,MAAM,EAAEP,KAAK,EAAE;EACxC,IAAMQ,GAAG,GAAG,EAAE;EAEdD,MAAM,CAACE,OAAO,CAAC,UAAAR,KAAK,EAAI;IACtB,IAAMS,GAAG,OAAAC,cAAA,CAAAC,OAAA,MAAQX,KAAK,CAAE;IACxB,IAAIS,GAAG,CAACG,QAAQ,EAAE;MAChBH,GAAG,CAACG,QAAQ,GAAGP,iBAAiB,CAACI,GAAG,CAACG,QAAQ,EAAEb,KAAK,CAAC;MACrD,IAAIU,GAAG,CAACG,QAAQ,IAAIH,GAAG,CAACG,QAAQ,CAACC,MAAM,GAAG,CAAC,EAAE;QAC3CN,GAAG,CAACO,IAAI,CAACL,GAAG,CAAC;MACf;IACF,CAAC,MAAM;MACL,IAAIX,aAAa,CAACC,KAAK,EAAEU,GAAG,CAAC,EAAE;QAC7BF,GAAG,CAACO,IAAI,CAACL,GAAG,CAAC;MACf;IACF;EACF,CAAC,CAAC;EAEF,OAAOF,GAAG;AACZ;AAEA,IAAMQ,UAAU,GAAG;EACjBC,KAAK,EAAE;IACLC,OAAO,EAAEC,yBAAiB;IAC1BC,UAAU,EAAE;EACd,CAAC;EACDC,SAAS,EAAE;IACTC,WAAW,EAAE,SAAbA,WAAWA,CAAGL,KAAK,EAAEC,OAAO,EAAK;MAC/BD,KAAK,CAACG,UAAU,GAAGF,OAAO;MAC1BD,KAAK,CAACC,OAAO,GAAGC,yBAAiB,CAACI,MAAM,CAACL,OAAO,CAAC;IACnD;EACF,CAAC;EACDM,OAAO,EAAE;IACPC,cAAc,WAAdA,cAAcA,CAAAC,IAAA,EAAaC,IAAI,EAAE;MAAA,IAAhBC,MAAM,GAAAF,IAAA,CAANE,MAAM;MACrB,OAAO,IAAIC,OAAO,CAAC,UAAAC,OAAO,EAAI;QAC5B,IAAQ9B,KAAK,GAAK2B,IAAI,CAAd3B,KAAK;QACb,IAAI+B,eAAe;QACnB,IAAI/B,KAAK,CAACK,QAAQ,CAAC,GAAG,CAAC,EAAE;UACvB0B,eAAe,GAAGC,sBAAc;QAClC,CAAC,MAAM;UACLD,eAAe,GAAGzB,iBAAiB,CAAC0B,sBAAc,EAAEhC,KAAK,CAAC;QAC5D;QACA4B,MAAM,CAAC,aAAa,EAAEG,eAAe,CAAC;QACtCD,OAAO,CAAC,CAAC;MACX,CAAC,CAAC;IACJ;EACF;AACF,CAAC;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAtB,OAAA,GAEcI,UAAU","ignoreList":[]}]}