{"remainingRequest":"C:\\dts-shop\\admin-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\dts-shop\\admin-ui\\src\\views\\mall\\order.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\dts-shop\\admin-ui\\src\\views\\mall\\order.vue","mtime":1714111780000},{"path":"C:\\dts-shop\\admin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742308433329},{"path":"C:\\dts-shop\\admin-ui\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1742308433476},{"path":"C:\\dts-shop\\admin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1742308433329},{"path":"C:\\dts-shop\\admin-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":1742308445120}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGxpc3RPcmRlciwgc2hpcE9yZGVyLCByZWZ1bmRPcmRlciwgZGV0YWlsT3JkZXIsIGxpc3RTaGlwQ2hhbm5lbCB9IGZyb20gJ0AvYXBpL2J1c2luZXNzL29yZGVyJwppbXBvcnQgUGFnaW5hdGlvbiBmcm9tICdAL2NvbXBvbmVudHMvUGFnaW5hdGlvbicgLy8gU2Vjb25kYXJ5IHBhY2thZ2UgYmFzZWQgb24gZWwtcGFnaW5hdGlvbgppbXBvcnQgY2hlY2tQZXJtaXNzaW9uIGZyb20gJ0AvdXRpbHMvcGVybWlzc2lvbicgLy8g5p2D6ZmQ5Yik5pat5Ye95pWwCgpjb25zdCBzdGF0dXNNYXAgPSB7CiAgMTAxOiAn5pyq5LuY5qy+JywKICAxMDI6ICfnlKjmiLflj5bmtognLAogIDEwMzogJ+ezu+e7n+WPlua2iCcsCiAgMjAxOiAn5bey5LuY5qy+JywKICAyMDI6ICfnlLPor7fpgIDmrL4nLAogIDIwMzogJ+W3sumAgOasvicsCiAgMzAxOiAn5bey5Y+R6LSnJywKICA0MDE6ICfnlKjmiLfmlLbotKcnLAogIDQwMjogJ+ezu+e7n+aUtui0pycKfQoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdPcmRlcicsCiAgY29tcG9uZW50czogeyBQYWdpbmF0aW9uIH0sCiAgZmlsdGVyczogewogICAgb3JkZXJTdGF0dXNGaWx0ZXIoc3RhdHVzKSB7CiAgICAgIHJldHVybiBzdGF0dXNNYXBbc3RhdHVzXQogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3Q6IHVuZGVmaW5lZCwKICAgICAgdG90YWw6IDAsCiAgICAgIGxpc3RMb2FkaW5nOiB0cnVlLAogICAgICBzaGlwQ2hhbm5lbExpc3Q6IFtdLAogICAgICBsaXN0UXVlcnk6IHsKICAgICAgICBwYWdlOiAxLAogICAgICAgIGxpbWl0OiAyMCwKICAgICAgICBpZDogdW5kZWZpbmVkLAogICAgICAgIG5hbWU6IHVuZGVmaW5lZCwKICAgICAgICBvcmRlclN0YXR1c0FycmF5OiBbXSwKICAgICAgICBzb3J0OiAnYWRkX3RpbWUnLAogICAgICAgIG9yZGVyOiAnZGVzYycKICAgICAgfSwKICAgICAgc3RhdHVzTWFwLAogICAgICBvcmRlckRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBvcmRlckRldGFpbDogewogICAgICAgIG9yZGVyOiB7fSwKICAgICAgICB1c2VyOiB7fSwKICAgICAgICBvcmRlckdvb2RzOiBbXQogICAgICB9LAogICAgICBzaGlwRm9ybTogewogICAgICAgIG9yZGVySWQ6IHVuZGVmaW5lZCwKICAgICAgICBzaGlwQ2hhbm5lbDogdW5kZWZpbmVkLAogICAgICAgIHNoaXBTbjogdW5kZWZpbmVkCiAgICAgIH0sCiAgICAgIHNoaXBEaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgcmVmdW5kRm9ybTogewogICAgICAgIG9yZGVySWQ6IHVuZGVmaW5lZCwKICAgICAgICByZWZ1bmRNb25leTogdW5kZWZpbmVkCiAgICAgIH0sCiAgICAgIHJlZnVuZERpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBkb3dubG9hZExvYWRpbmc6IGZhbHNlCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRMaXN0KCkKICAgIHRoaXMuZ2V0TGlzdFNoaXBDaGFubmVsKCkKICB9LAogIG1ldGhvZHM6IHsKICAgIGNoZWNrUGVybWlzc2lvbiwKICAgIGdldExpc3QoKSB7CiAgICAgIHRoaXMubGlzdExvYWRpbmcgPSB0cnVlCiAgICAgIGxpc3RPcmRlcih0aGlzLmxpc3RRdWVyeSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5saXN0ID0gcmVzcG9uc2UuZGF0YS5kYXRhLml0ZW1zCiAgICAgICAgdGhpcy50b3RhbCA9IHJlc3BvbnNlLmRhdGEuZGF0YS50b3RhbAogICAgICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZQogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy5saXN0ID0gW10KICAgICAgICB0aGlzLnRvdGFsID0gMAogICAgICAgIHRoaXMubGlzdExvYWRpbmcgPSBmYWxzZQogICAgICB9KQogICAgfSwKICAgIGdldExpc3RTaGlwQ2hhbm5lbCgpIHsKICAgICAgbGlzdFNoaXBDaGFubmVsKCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5zaGlwQ2hhbm5lbExpc3QgPSByZXNwb25zZS5kYXRhLmRhdGEuc2hpcENoYW5uZWxMaXN0CiAgICAgIH0pCiAgICB9LAogICAgaGFuZGxlRmlsdGVyKCkgewogICAgICB0aGlzLmxpc3RRdWVyeS5wYWdlID0gMQogICAgICB0aGlzLmdldExpc3QoKQogICAgfSwKICAgIGhhbmRsZURldGFpbChyb3cpIHsKICAgICAgZGV0YWlsT3JkZXIocm93LmlkKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLm9yZGVyRGV0YWlsID0gcmVzcG9uc2UuZGF0YS5kYXRhCiAgICAgIH0pCiAgICAgIHRoaXMub3JkZXJEaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgfSwKICAgIGhhbmRsZVNoaXAocm93KSB7CiAgICAgIHRoaXMuc2hpcEZvcm0ub3JkZXJJZCA9IHJvdy5pZAogICAgICB0aGlzLnNoaXBGb3JtLnNoaXBDaGFubmVsID0gcm93LnNoaXBDaGFubmVsCiAgICAgIHRoaXMuc2hpcEZvcm0uc2hpcFNuID0gcm93LnNoaXBTbgoKICAgICAgdGhpcy5zaGlwRGlhbG9nVmlzaWJsZSA9IHRydWUKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnNbJ3NoaXBGb3JtJ10uY2xlYXJWYWxpZGF0ZSgpCiAgICAgIH0pCiAgICB9LAogICAgY29uZmlybVNoaXAoKSB7CiAgICAgIHRoaXMuJHJlZnNbJ3NoaXBGb3JtJ10udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBzaGlwT3JkZXIodGhpcy5zaGlwRm9ybSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIHRoaXMuc2hpcERpYWxvZ1Zpc2libGUgPSBmYWxzZQogICAgICAgICAgICB0aGlzLiRub3RpZnkuc3VjY2Vzcyh7CiAgICAgICAgICAgICAgdGl0bGU6ICfmiJDlip8nLAogICAgICAgICAgICAgIG1lc3NhZ2U6ICfnoa7orqTlj5HotKfmiJDlip8nCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpCiAgICAgICAgICB9KS5jYXRjaChyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIHRoaXMuJG5vdGlmeS5lcnJvcih7CiAgICAgICAgICAgICAgdGl0bGU6ICflpLHotKUnLAogICAgICAgICAgICAgIG1lc3NhZ2U6IHJlc3BvbnNlLmRhdGEuZXJybXNnCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBoYW5kbGVSZWZ1bmQocm93KSB7CiAgICAgIHRoaXMucmVmdW5kRm9ybS5vcmRlcklkID0gcm93LmlkCiAgICAgIHRoaXMucmVmdW5kRm9ybS5yZWZ1bmRNb25leSA9IHJvdy5hY3R1YWxQcmljZQoKICAgICAgdGhpcy5yZWZ1bmREaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmc1sncmVmdW5kRm9ybSddLmNsZWFyVmFsaWRhdGUoKQogICAgICB9KQogICAgfSwKICAgIGNvbmZpcm1SZWZ1bmQoKSB7CiAgICAgIHRoaXMuJHJlZnNbJ3JlZnVuZEZvcm0nXS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHJlZnVuZE9yZGVyKHRoaXMucmVmdW5kRm9ybSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIHRoaXMucmVmdW5kRGlhbG9nVmlzaWJsZSA9IGZhbHNlCiAgICAgICAgICAgIHRoaXMuJG5vdGlmeS5zdWNjZXNzKHsKICAgICAgICAgICAgICB0aXRsZTogJ+aIkOWKnycsCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+ehruiupOmAgOasvuaIkOWKnycKICAgICAgICAgICAgfSkKICAgICAgICAgICAgdGhpcy5nZXRMaXN0KCkKICAgICAgICAgIH0pLmNhdGNoKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgdGhpcy4kbm90aWZ5LmVycm9yKHsKICAgICAgICAgICAgICB0aXRsZTogJ+Wksei0pScsCiAgICAgICAgICAgICAgbWVzc2FnZTogcmVzcG9uc2UuZGF0YS5lcnJtc2cKICAgICAgICAgICAgfSkKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGhhbmRsZURvd25sb2FkKCkgewogICAgICB0aGlzLmRvd25sb2FkTG9hZGluZyA9IHRydWUKICAgICAgaW1wb3J0KCdAL3ZlbmRvci9FeHBvcnQyRXhjZWwnKS50aGVuKGV4Y2VsID0+IHsKICAgICAgICBjb25zdCB0SGVhZGVyID0gWyforqLljZVJRCcsICforqLljZXnvJblj7cnLCAn55So5oi3SUQnLCAn6K6i5Y2V54q25oCBJywgJ+aYr+WQpuWIoOmZpCcsICfmlLbotKfkuronLCAn5pS26LSn6IGU57O755S16K+dJywgJ+aUtui0p+WcsOWdgCddCiAgICAgICAgY29uc3QgZmlsdGVyVmFsID0gWydpZCcsICdvcmRlclNuJywgJ3VzZXJJZCcsICdvcmRlclN0YXR1cycsICdpc0RlbGV0ZScsICdjb25zaWduZWUnLCAnbW9iaWxlJywgJ2FkZHJlc3MnXQogICAgICAgIGV4Y2VsLmV4cG9ydF9qc29uX3RvX2V4Y2VsMih0SGVhZGVyLCB0aGlzLmxpc3QsIGZpbHRlclZhbCwgJ+iuouWNleS/oeaBrycpCiAgICAgICAgdGhpcy5kb3dubG9hZExvYWRpbmcgPSBmYWxzZQogICAgICB9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmJA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"order.vue","sourceRoot":"src/views/mall","sourcesContent":["<template>\n  <div class=\"app-container\">\n\n    <!-- 查询和其他操作 -->\n    <div class=\"filter-container\">\n      <el-input v-model=\"listQuery.userId\" clearable size=\"mini\" class=\"filter-item\" style=\"width: 200px;\" placeholder=\"请输入用户ID\"/>\n      <el-input v-model=\"listQuery.orderSn\" clearable size=\"mini\" class=\"filter-item\" style=\"width: 200px;\" placeholder=\"请输入订单编号\"/>\n      <el-select v-model=\"listQuery.orderStatusArray\" multiple size=\"mini\" style=\"width: 200px\" class=\"filter-item\" placeholder=\"请选择订单状态\">\n        <el-option v-for=\"(key, value) in statusMap\" :key=\"key\" :label=\"key\" :value=\"value\"/>\n      </el-select>\n      <el-button v-permission=\"['GET /admin/order/list']\" size=\"mini\" class=\"filter-item\" type=\"primary\" icon=\"el-icon-search\" @click=\"handleFilter\">查找</el-button>\n      <el-button :loading=\"downloadLoading\" size=\"mini\" class=\"filter-item\" type=\"warning\" icon=\"el-icon-download\" @click=\"handleDownload\">导出</el-button>\n    </div>\n\n    <!-- 查询结果 -->\n    <el-table v-loading=\"listLoading\" :data=\"list\" size=\"small\" element-loading-text=\"正在查询中。。。\" border fit highlight-current-row>\n\n      <el-table-column align=\"center\" min-width=\"100\" label=\"订单编号\" prop=\"orderSn\" sortable/>\n\n      <el-table-column align=\"center\" min-width=\"100px\" label=\"用户ID\" prop=\"userId\"/>\n\n      <el-table-column align=\"center\" min-width=\"100px\" label=\"订单状态\" prop=\"orderStatus\">\n        <template slot-scope=\"scope\">\n          <el-tag>{{ scope.row.orderStatus | orderStatusFilter }}</el-tag>\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" min-width=\"100px\" label=\"订单金额\" prop=\"orderPrice\"/>\n\n      <el-table-column align=\"center\" min-width=\"100px\" label=\"支付金额\" prop=\"actualPrice\"/>\n\n      <el-table-column align=\"center\" min-width=\"120px\" label=\"支付时间\" prop=\"payTime\"/>\n\n      <el-table-column align=\"center\" min-width=\"120px\" label=\"物流单号\" prop=\"shipSn\"/>\n\n      <el-table-column align=\"center\" min-width=\"100px\" label=\"物流渠道\" prop=\"shipChannel\"/>\n\n      <el-table-column align=\"center\" label=\"操作\" min-width=\"150px\" class-name=\"small-padding fixed-width\">\n        <template slot-scope=\"scope\">\n          <el-button v-permission=\"['GET /admin/order/detail']\" type=\"primary\" size=\"mini\" @click=\"handleDetail(scope.row)\">详情</el-button>\n          <el-button v-permission=\"['POST /admin/order/ship']\" v-if=\"scope.row.orderStatus==201\" type=\"primary\" size=\"mini\" @click=\"handleShip(scope.row)\">发货</el-button>\n          <el-button v-permission=\"['POST /admin/order/refund']\" v-if=\"scope.row.orderStatus==202\" type=\"primary\" size=\"mini\" @click=\"handleRefund(scope.row)\">退款</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <pagination v-show=\"total>0\" :total=\"total\" :page.sync=\"listQuery.page\" :limit.sync=\"listQuery.limit\" @pagination=\"getList\" />\n\n    <!-- 订单详情对话框 -->\n    <el-dialog :visible.sync=\"orderDialogVisible\" title=\"订单详情\" width=\"800\">\n      <el-form :data=\"orderDetail\" label-position=\"left\">\n        <el-form-item label=\"订单编号\">\n          <span>{{ orderDetail.order.orderSn }}</span>\n        </el-form-item>\n        <el-form-item label=\"订单状态\">\n          <template slot-scope=\"scope\">\n            <el-tag>{{ scope.order.orderStatus | orderStatusFilter }}</el-tag>\n          </template>\n        </el-form-item>\n        <el-form-item label=\"订单用户\">\n          <span>{{ orderDetail.user.nickname }}</span>\n        </el-form-item>\n        <el-form-item label=\"用户留言\">\n          <span>{{ orderDetail.order.message }}</span>\n        </el-form-item>\n        <el-form-item label=\"收货信息\">\n          <span>（收货人）{{ orderDetail.order.consignee }}</span>\n          <span>（手机号）{{ orderDetail.order.mobile }}</span>\n          <span>（地址）{{ orderDetail.order.address }}</span>\n        </el-form-item>\n        <el-form-item label=\"商品信息\">\n          <el-table :data=\"orderDetail.orderGoods\" size=\"small\" border fit highlight-current-row>\n            <el-table-column align=\"center\" label=\"商品名称\" prop=\"goodsName\" />\n            <el-table-column align=\"center\" label=\"商品编号\" prop=\"goodsSn\" />\n            <el-table-column align=\"center\" label=\"货品规格\" prop=\"specifications\" />\n            <el-table-column align=\"center\" label=\"货品价格\" prop=\"price\" />\n            <el-table-column align=\"center\" label=\"货品数量\" prop=\"number\" />\n            <el-table-column align=\"center\" label=\"货品图片\" prop=\"picUrl\">\n              <template slot-scope=\"scope\">\n                <img :src=\"scope.row.picUrl\" width=\"40\">\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-form-item>\n        <el-form-item label=\"费用信息\">\n          <span>\n            (实际费用){{ orderDetail.order.actualPrice }}元 =\n            (商品总价){{ orderDetail.order.goodsPrice }}元 +\n            (快递费用){{ orderDetail.order.freightPrice }}元 -\n            (优惠减免){{ orderDetail.order.couponPrice }}元 -\n            (积分减免){{ orderDetail.order.integralPrice }}元\n          </span>\n        </el-form-item>\n        <el-form-item label=\"支付信息\">\n          <span>（支付渠道）微信支付</span>\n          <span>（支付时间）{{ orderDetail.order.payTime }}</span>\n        </el-form-item>\n        <el-form-item label=\"快递信息\">\n          <span>（快递公司）{{ orderDetail.order.shipChannel }}</span>\n          <span>（快递单号）{{ orderDetail.order.shipSn }}</span>\n          <span>（发货时间）{{ orderDetail.order.shipTime }}</span>\n        </el-form-item>\n        <el-form-item label=\"收货信息\">\n          <span>（确认收货时间）{{ orderDetail.order.confirmTime }}</span>\n        </el-form-item>\n      </el-form>\n    </el-dialog>\n\n    <!-- 发货对话框 -->\n    <el-dialog :visible.sync=\"shipDialogVisible\" title=\"发货\">\n      <el-form ref=\"shipForm\" :model=\"shipForm\" status-icon label-position=\"left\" label-width=\"100px\" style=\"width: 400px; margin-left:50px;\">\n        <el-form-item label=\"快递公司\" prop=\"shipChannel\">\n          <el-select v-model=\"shipForm.shipChannel\">\n            <el-option v-for=\"item in shipChannelList\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"/>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"快递编号\" prop=\"shipSn\">\n          <el-input v-model=\"shipForm.shipSn\"/>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"shipDialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmShip\">确定</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 退款对话框 -->\n    <el-dialog :visible.sync=\"refundDialogVisible\" title=\"退款\">\n      <el-form ref=\"refundForm\" :model=\"refundForm\" status-icon label-position=\"left\" label-width=\"100px\" style=\"width: 400px; margin-left:50px;\">\n        <el-form-item label=\"退款金额\" prop=\"refundMoney\">\n          <el-input v-model=\"refundForm.refundMoney\" :disabled=\"true\"/>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"refundDialogVisible = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmRefund\">确定</el-button>\n      </div>\n    </el-dialog>\n\n  </div>\n</template>\n\n<style>\n\n</style>\n\n<script>\nimport { listOrder, shipOrder, refundOrder, detailOrder, listShipChannel } from '@/api/business/order'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nimport checkPermission from '@/utils/permission' // 权限判断函数\n\nconst statusMap = {\n  101: '未付款',\n  102: '用户取消',\n  103: '系统取消',\n  201: '已付款',\n  202: '申请退款',\n  203: '已退款',\n  301: '已发货',\n  401: '用户收货',\n  402: '系统收货'\n}\n\nexport default {\n  name: 'Order',\n  components: { Pagination },\n  filters: {\n    orderStatusFilter(status) {\n      return statusMap[status]\n    }\n  },\n  data() {\n    return {\n      list: undefined,\n      total: 0,\n      listLoading: true,\n      shipChannelList: [],\n      listQuery: {\n        page: 1,\n        limit: 20,\n        id: undefined,\n        name: undefined,\n        orderStatusArray: [],\n        sort: 'add_time',\n        order: 'desc'\n      },\n      statusMap,\n      orderDialogVisible: false,\n      orderDetail: {\n        order: {},\n        user: {},\n        orderGoods: []\n      },\n      shipForm: {\n        orderId: undefined,\n        shipChannel: undefined,\n        shipSn: undefined\n      },\n      shipDialogVisible: false,\n      refundForm: {\n        orderId: undefined,\n        refundMoney: undefined\n      },\n      refundDialogVisible: false,\n      downloadLoading: false\n    }\n  },\n  created() {\n    this.getList()\n    this.getListShipChannel()\n  },\n  methods: {\n    checkPermission,\n    getList() {\n      this.listLoading = true\n      listOrder(this.listQuery).then(response => {\n        this.list = response.data.data.items\n        this.total = response.data.data.total\n        this.listLoading = false\n      }).catch(() => {\n        this.list = []\n        this.total = 0\n        this.listLoading = false\n      })\n    },\n    getListShipChannel() {\n      listShipChannel().then(response => {\n        this.shipChannelList = response.data.data.shipChannelList\n      })\n    },\n    handleFilter() {\n      this.listQuery.page = 1\n      this.getList()\n    },\n    handleDetail(row) {\n      detailOrder(row.id).then(response => {\n        this.orderDetail = response.data.data\n      })\n      this.orderDialogVisible = true\n    },\n    handleShip(row) {\n      this.shipForm.orderId = row.id\n      this.shipForm.shipChannel = row.shipChannel\n      this.shipForm.shipSn = row.shipSn\n\n      this.shipDialogVisible = true\n      this.$nextTick(() => {\n        this.$refs['shipForm'].clearValidate()\n      })\n    },\n    confirmShip() {\n      this.$refs['shipForm'].validate((valid) => {\n        if (valid) {\n          shipOrder(this.shipForm).then(response => {\n            this.shipDialogVisible = false\n            this.$notify.success({\n              title: '成功',\n              message: '确认发货成功'\n            })\n            this.getList()\n          }).catch(response => {\n            this.$notify.error({\n              title: '失败',\n              message: response.data.errmsg\n            })\n          })\n        }\n      })\n    },\n    handleRefund(row) {\n      this.refundForm.orderId = row.id\n      this.refundForm.refundMoney = row.actualPrice\n\n      this.refundDialogVisible = true\n      this.$nextTick(() => {\n        this.$refs['refundForm'].clearValidate()\n      })\n    },\n    confirmRefund() {\n      this.$refs['refundForm'].validate((valid) => {\n        if (valid) {\n          refundOrder(this.refundForm).then(response => {\n            this.refundDialogVisible = false\n            this.$notify.success({\n              title: '成功',\n              message: '确认退款成功'\n            })\n            this.getList()\n          }).catch(response => {\n            this.$notify.error({\n              title: '失败',\n              message: response.data.errmsg\n            })\n          })\n        }\n      })\n    },\n    handleDownload() {\n      this.downloadLoading = true\n      import('@/vendor/Export2Excel').then(excel => {\n        const tHeader = ['订单ID', '订单编号', '用户ID', '订单状态', '是否删除', '收货人', '收货联系电话', '收货地址']\n        const filterVal = ['id', 'orderSn', 'userId', 'orderStatus', 'isDelete', 'consignee', 'mobile', 'address']\n        excel.export_json_to_excel2(tHeader, this.list, filterVal, '订单信息')\n        this.downloadLoading = false\n      })\n    }\n  }\n}\n</script>\n"]}]}